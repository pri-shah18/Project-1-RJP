---
title: "Fuel vs Tyre Analysis"
output: html_notebook
---

#1. Overview
This notebook uses k-means clustering to group fuel usage to tire spend.

Problem Statement for Project-1-RJP
For a medium sized fleet of a grounds maintenance company there is a robust methodology in use for creating a fuel use projection for the coming year. However tyre costs fluctuate and previous budget projections have been inaccurate.
"Can we use K means clustering to provide a model of a relationship between fuel costs and tyre costs for the previous year, which could be used to improve the budget projection for future tyre costs?"
For this exercise solely focus on fuel cost and tyre cost relationship

#2. Load libraries
The Tidyverse is a collection of libraries that incudes all of the libraries that are required to complete this analysis

```{r}
# install.packages("tidyverse") (had to do this first but one time only)
library(tidyverse)
```

This is a good time to set wd:
```{r}
#> setwd("/Data-fellowship/data-projects/Tyres and Fuel 2018")
```

# 3. Load Data
#For this exercise vehicles with zero tyre spend were excluded

```{r}
ruth <- read.csv("Data.csv")
head(ruth)
```

# 4. Explore and transform data

Change titles
```{r}
names(ruth) <- c("Reg","Fuel","Tyre")
head(ruth)
```
# 5.Visualise data with initial scattergraph
```{r}
#could use ggplot but unneccessary for simple data
#ggplot(data = ruth, aes(x = ruth$Fuel, y = ruth$Tyre)) 
qplot(x = ruth$Fuel, y = ruth$Tyre,)



```
# 6. fine tuning kmeans
```{r}
kclustermax <- 10
wss <- sapply(1:kclustermax, function(k){kmeans(ruth[c("Fuel","Tyre")],k)$tot.withinss})
plot(1:kclustermax,wss, type="b", pch = 21, frame = FALSE, xlab="Number of clusters K", ylab = "Total Within Clusters sum of Squares")
```

# 7. Modelling (clustering)

```{r}
# from work above assume that our dataset has 5 clusters
kclusters <- 5
kmeansresult <- kmeans(ruth[c("Fuel","Tyre")], centers = kclusters)
#increase number of columns in c notation for increased variables
ruth$Cluster <- kmeansresult$cluster
ruth$Cluster <- as.factor(ruth$Cluster)
head(ruth)
#show as a ggplot
ggplot(ruth, aes(x = ruth$Fuel, y = ruth$Tyre)) + geom_point(aes(colour = ruth$Cluster))
#or a qplot
qplot(x = ruth$Tyre, y = ruth$Fuel, color = ruth$Cluster)
```

#8. Show K Means Values

```{r}
print(kmeansresult)
```
#9. Conclusion
```{r}
#K-means clustering does not provide a model to predict tyre costs from the quantity of fuel purchased. So the conclusion is either:
#a.) An alternative clustering method is needed
#b.) There is no relationship between the two variables that can be used to predict costs
#c.) There is another factor not being considered which needs to be used (this may be useful for a future project)
```


